% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Additional_functions.R
\name{feature_sim_grouped_singletons}
\alias{feature_sim_grouped_singletons}
\title{Simulate grouped features with AR(1) within-group correlation with singleton consideration}
\usage{
feature_sim_grouped_singletons(
  N,
  p,
  group_ind,
  AR = 0.25,
  nonNull_indices,
  signal_vec,
  singletons = TRUE
)
}
\arguments{
\item{N}{Sample size.}

\item{p}{Total number of coefficients including intercept.}

\item{group_ind}{Grouping vector for predictors (length \code{p-1}).}

\item{AR}{AR(1) correlation parameter within groups and between singletons.}

\item{nonNull_indices}{Indices in \code{2:p} set to non-null.}

\item{signal_vec}{Signal values to assign at \code{nonNull_indices}.}

\item{singletons}{Logical. If TRUE, singleton features are simulated jointly with correlation.}
}
\value{
A list containing \code{beta_true}, \code{X}, \code{K}, and related metadata.
}
\description{
Generates block-diagonal Gaussian features by group using an AR(1) correlation
within each group. If \code{singletons = TRUE}, singleton features are simulated jointly
with a shared correlation structure.
}
